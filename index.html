<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Annabel & Amelia's Chore Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      background: transparent;
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      color: #ffffff;
      transform: scale(0.85);
      transform-origin: top center;
      overflow: hidden;
    }

    h2 {
      font-family: 'Luckiest Guy', cursive;
      font-size: 28px;
      margin: 10px 0 5px;
      color: #ffdd57;
      text-shadow: 1px 1px 5px #000, 0 0 10px #ffcc00;
    }

    .container {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
    }

    .child-panel {
      width: 45%;
      padding: 10px;
    }

    .section-title {
      font-size: 22px;
      margin-top: 10px;
      margin-bottom: 5px;
      color: #00ffc8;
    }

    .total, .lifetime {
      font-size: 26px;
      margin: 5px 0;
      color: #00ffc8;
      text-shadow: 0 0 12px rgba(0,255,200,0.7);
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0 auto 15px;
      max-width: 300px;
      text-align: left;
    }

    li {
      font-size: 18px;
      margin: 6px 0;
    }

    input[type="checkbox"] {
      transform: scale(1.2);
      margin-right: 10px;
    }

    .manual-adjust {
      margin: 5px 0 15px;
    }

    .manual-adjust button {
      padding: 5px 12px;
      font-size: 18px;
      font-weight: bold;
      margin: 0 5px;
      border-radius: 8px;
      border: none;
      background-color: #00c6ff;
      color: white;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .manual-adjust button:hover {
      background-color: #00a2d8;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="child-panel" id="annabel">
      <h2>Annabel</h2>
      <div class="section-title">Paid Chores</div>
      <ul id="annabel-paid"></ul>
      <div class="total" id="annabel-total">$0.00</div>
      <div class="lifetime" id="annabel-lifetime">Lifetime: $0.00</div>
      <div class="manual-adjust">
        <button onclick="adjustTotal('annabel', -1)">−</button>
        <button onclick="adjustTotal('annabel', 1)">+</button>
        <button onclick="markPaid('annabel')">Paid</button>
      </div>
      <div class="section-title">Required Chores</div>
      <ul id="annabel-required"></ul>
    </div>

    <div class="child-panel" id="amelia">
      <h2>Amelia</h2>
      <div class="section-title">Paid Chores</div>
      <ul id="amelia-paid"></ul>
      <div class="total" id="amelia-total">$0.00</div>
      <div class="lifetime" id="amelia-lifetime">Lifetime: $0.00</div>
      <div class="manual-adjust">
        <button onclick="adjustTotal('amelia', -1)">−</button>
        <button onclick="adjustTotal('amelia', 1)">+</button>
        <button onclick="markPaid('amelia')">Paid</button>
      </div>
      <div class="section-title">Required Chores</div>
      <ul id="amelia-required"></ul>
    </div>
  </div>

  <script>
    const children = [
      {
        name: 'annabel',
        paid: [
          { id: 'ab1', name: 'Make bed', value: 1 },
          { id: 'ab2', name: 'Empty dishwasher', value: 1 },
          { id: 'ab3', name: 'Feed dog', value: 1 }
        ],
        required: [
          { id: 'ab4', name: 'Brush teeth' },
          { id: 'ab5', name: 'Do homework' }
        ]
      },
      {
        name: 'amelia',
        paid: [
          { id: 'am1', name: 'Clean room', value: 1 },
          { id: 'am2', name: 'Water plants', value: 1 },
          { id: 'am3', name: 'Help set table', value: 1 }
        ],
        required: [
          { id: 'am4', name: 'Brush hair' },
          { id: 'am5', name: 'Pack backpack' }
        ]
      }
    ];

    function formatCurrency(val) {
      return val.toLocaleString("en-US", { style: "currency", currency: "USD" });
    }

    function getTodayKey(name) {
      const today = new Date();
      return `${name}_chores_${today.getFullYear()}-${today.getMonth()}-${today.getDate()}`;
    }

    function getEarningsKey(name) {
      return `${name}_current_earnings`;
    }

    function getLifetimeKey(name) {
      return `${name}_lifetime_earnings`;
    }

    function getChoreKey(name) {
      return `${name}_chore_values`;
    }

    function loadChild(child) {
      const paidList = document.getElementById(`${child.name}-paid`);
      const reqList = document.getElementById(`${child.name}-required`);
      const totalDisplay = document.getElementById(`${child.name}-total`);
      const lifetimeDisplay = document.getElementById(`${child.name}-lifetime`);

      const paidKey = getTodayKey(child.name) + '_paid';
      const requiredKey = getTodayKey(child.name) + '_required';
      const earningsKey = getEarningsKey(child.name);
      const lifetimeKey = getLifetimeKey(child.name);
      const choreKey = getChoreKey(child.name);

      let completedPaid = JSON.parse(localStorage.getItem(paidKey) || '{}');
      let completedRequired = JSON.parse(localStorage.getItem(requiredKey) || '{}');
      let earnedFromChores = JSON.parse(localStorage.getItem(choreKey) || '{}');
      let total = parseFloat(localStorage.getItem(earningsKey)) || 0;
      let lifetime = parseFloat(localStorage.getItem(lifetimeKey)) || 0;

      paidList.innerHTML = '';
      reqList.innerHTML = '';

      child.paid.forEach(chore => {
        const li = document.createElement('li');
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = chore.id;
        checkbox.checked = completedPaid[chore.id] || false;

        checkbox.addEventListener('change', () => {
          const isChecked = checkbox.checked;
          completedPaid[chore.id] = isChecked;
          localStorage.setItem(paidKey, JSON.stringify(completedPaid));

          if (isChecked && !earnedFromChores[chore.id]) {
            total += chore.value;
            earnedFromChores[chore.id] = true;
            localStorage.setItem(earningsKey, total.toString());
            localStorage.setItem(choreKey, JSON.stringify(earnedFromChores));
            totalDisplay.textContent = formatCurrency(total);
          }
        });

        const label = document.createElement('label');
        label.htmlFor = chore.id;
        label.textContent = chore.name;
        li.appendChild(checkbox);
        li.appendChild(label);
        paidList.appendChild(li);
      });

      child.required.forEach(chore => {
        const li = document.createElement('li');
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = chore.id;
        checkbox.checked = completedRequired[chore.id] || false;

        checkbox.addEventListener('change', () => {
          completedRequired[chore.id] = checkbox.checked;
          localStorage.setItem(requiredKey, JSON.stringify(completedRequired));
        });

        const label = document.createElement('label');
        label.htmlFor = chore.id;
        label.textContent = chore.name;
        li.appendChild(checkbox);
        li.appendChild(label);
        reqList.appendChild(li);
      });

      totalDisplay.textContent = formatCurrency(total);
      lifetimeDisplay.textContent = `Lifetime: ${formatCurrency(lifetime)}`;
    }

    function adjustTotal(name, delta) {
      const earningsKey = getEarningsKey(name);
      const totalDisplay = document.getElementById(`${name}-total`);
      let total = parseFloat(localStorage.getItem(earningsKey)) || 0;
      total += delta;
      if (total < 0) total = 0;
      localStorage.setItem(earningsKey, total.toString());
      totalDisplay.textContent = formatCurrency(total);
    }

    function markPaid(name) {
      const earningsKey = getEarningsKey(name);
      const lifetimeKey = getLifetimeKey(name);
      const choreKey = getChoreKey(name);
      const totalDisplay = document.getElementById(`${name}-total`);
      const lifetimeDisplay = document.getElementById(`${name}-lifetime`);

      let total = parseFloat(localStorage.getItem(earningsKey)) || 0;
      let lifetime = parseFloat(localStorage.getItem(lifetimeKey)) || 0;
      lifetime += total;

      localStorage.setItem(lifetimeKey, lifetime.toString());
      localStorage.setItem(earningsKey, "0");
      localStorage.removeItem(choreKey);

      totalDisplay.textContent = formatCurrency(0);
      lifetimeDisplay.textContent = `Lifetime: ${formatCurrency(lifetime)}`;
    }

    children.forEach(loadChild);
  </script>
</body>
</html>
